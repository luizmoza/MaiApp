<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>MaiApp - Cadastro de Emissor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="../static/images/icon/favicon.ico">
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/font-awesome.min.css">
    <link rel="stylesheet" href="../static/css/themify-icons.css">
    <link rel="stylesheet" href="../static/css/metisMenu.css">
    <link rel="stylesheet" href="../static/css/owl.carousel.min.css">
    <link rel="stylesheet" href="../static/css/slicknav.min.css">
    <link rel="stylesheet" href="../static/css/typography.css">
    <link rel="stylesheet" href="../static/css/default-css.css">
    <link rel="stylesheet" href="../static/css/responsive.css">
    <link rel="stylesheet" href="../static/css/styles.css">

    <script src="../static/js/util.js"></script>



</head>

<body>

<input id="hfUsuario_Id" type="hidden" value='{{ Usuario_Id }}'>
<input id="hfUsuario_Email" type="hidden" value='{{ Usuario_Email }}'>
<input id="hfUsuario_Auth" type="hidden" value='{{ Usuario_Auth }}'>
<input id="hfpicture" type="hidden" value='{{ picture }}'>
<input id="hfHeaderUserName" type="hidden" value='{{ HeaderUserName }}'>
    


                                <div class="modal fade" id="ModalMsgBox" Name="ModalMsgBox">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">Mensagem</h5>
                                                <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                                            </div>
                                            <div class="modal-body" id="tbModalMsgBox" name="tbModalMsgBox" style="height:25vh;">
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>



   <div id="preloader">
        <div class="loader"></div>
    </div>


    <div class="page-container">
        {{ SideBar }}
        <div class="main-content">
            {{ Header }}
         <div class="main-content-inner">
                <div class="row">
                    <div class="col-lg-6 col-ml-12">
                        <div class="row">
                            <div class="col-12 mt-5">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="header-title">Emissor</h4>

<!-- Formulario MAIN -->
                                        <form>
                                            <div class="form-row align-items-center">
                                                <div class="col-sm-3 my-1">
                                                    <fieldset disabled>
													<div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">idEmissor</div></div>
                                                        <input type="text" class="form-control" id="tbIDEmissor" placeholder="">
                                                    </div>
													</fieldset>
                                                </div>
                                               <div class="col-sm-9 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Nome</div></div>
                                                        <input type="text" class="form-control" id="tbNome" placeholder="Ex : Petrobras">
                                                    </div>
                                                </div>
												<div class="col-sm-12 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">CGC</div></div>
                                                        <input type="text" class="form-control" id="tbcgc" placeholder="Ex : 00000000000000">
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Grupo Economico</div></div>
                                                        <input type="text" class="form-control" id="tbGrupo" placeholder="Ex : Petrobras">
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Rating</div></div>
                                                        <input type="text" class="form-control" id="tbRating" placeholder="Ex : AAA">
                                                    </div>
                                                </div>
												<div class="col-sm-6 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Agencia</div></div>
                                                        <input type="text" class="form-control" id="tbAgencia" placeholder="Ex : FITCH">
                                                    </div>
                                                </div>
												<div class="col-sm-6 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Rating MAI</div></div>
                                                        <input type="text" class="form-control" id="tbRatingMAI" placeholder="Ex : AAA">
                                                    </div>
                                                </div>
												<div class="col-sm-6 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Código Mellon</div></div>
                                                        <input type="text" class="form-control" id="tbAliasMellon" placeholder="Ex : PETR">
                                                    </div>
                                                </div>
												<div class="col-sm-6 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Código Bradesco</div></div>
                                                        <input type="text" class="form-control" id="tbAliasBradesco" placeholder="Ex : PETR">
                                                    </div>
                                                </div>
												<div class="col-sm-6 my-1">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend"><div class="input-group-text">Código Itau</div></div>
                                                        <input type="text" class="form-control" id="tbAliasItau" placeholder="Ex : PETR">
                                                    </div>
                                                </div>
                                            </div>

<!-- Formulario Checkboxes -->
                                         

										<div class="form-row align-items-center">
                                            <div class="col-sm-2 my-1" style="Margin-Left:20px;">
												<div class="s-settings">
													<p style="Margin:20px 0px 20px 0px;" ></p>
													<div class="s-sw-title" style="background-color:#F2F7FA;border-radius:25px;">
														<h5 style="Margin-Left:5px;">Nacional</h5>
														<div class="s-swtich">
															<input type="checkbox" id="cbNacional" />
															<label for="cbNacional">Toggle</label>
														</div>
													</div>
												</div>
											</div>
										</div>


<!-- Formulario Combo Boxes -->

                                            <div class="form-group row">
                                                <div class="col-sm-6 my-1">
   												<label>Categoria</label>
                                                    <div class="input-group">
														<select id="SlctCategoria" class="form-control" style="font-size: 80%;">
                                                        <option>N/A</option>
                                                        <option>Açucar e Álcool</option>
                                                        <option>Água E Saneamento</option>
                                                        <option>Alimentos e Bebidas</option>
                                                        <option>Aluguel de Carros</option>
                                                        <option>Análises Clínicas E Medicina Diagnóstica</option>
                                                        <option>Banco grande</option>
                                                        <option>Banco médio</option>
                                                        <option>Banco pequeno</option>
                                                        <option>Comércio E Produtos de Perfumaria</option>
                                                        <option>Consumo Cíclico / Automóveis e Motocicletas</option>
                                                        <option>Corporativo</option>
                                                        <option>Desenvolvimento de Imóveis</option>
                                                        <option>Educação</option>
                                                        <option>Energia Elétrica</option>
                                                        <option>Exploração de Imóveis</option>
                                                        <option>Exploração De Rodovias</option>
                                                        <option>Instituição Financeira</option>
                                                        <option>Petróleo e Gás</option>
                                                        <option>Serviços de Gás</option>
                                                        <option>Serviços Financeiros Diversos</option>
                                                        <option>Soberano</option>
                                                        <option>Telecomunicações</option>
                                                        <option>Transporte Ferroviário</option>
                                                        <option>Varejo</option>
                                                        <option>Alimentos e Bebidas</option>
                                                        <option>Aluguel de Carros</option>
                                                        <option>Água E Saneamento</option>
                                                        <option>Educação</option>
                                                        <option>Energia Elétrica</option>
                                                        <option>Fundo de Investimento</option>
                                                        <option>Telecomunicações</option>
                                                        <option>Agropecuária</option>
                                                        <option>Comércio e Distribuição</option>
                                                        <option>Computadores e Equipamentos</option>
                                                        <option>Construção e Engenharia</option>
                                                        <option>Construção e Engenharia</option>
                                                        <option>Embalagens</option>
                                                        <option>Máquinas e Equipamentos</option>
                                                        <option>Hoteis e Restaurantes</option>
                                                        <option>Madeira e Papel</option>
                                                        <option>Medicamentos e Outros Produtos</option>
                                                        <option>Mídia</option>
                                                        <option>Mineração</option>
                                                        <option>Mineração</option>
                                                        <option>Petróleo. Gás e Biocombustíveis</option>
                                                        <option>Previdência e Seguros</option>
                                                        <option>Produtos de Uso Pessoal e de Limpeza</option>
                                                        <option>Químicos</option>
                                                        <option>Securitizadoras de Recebíveis</option>
                                                        <option>Serv.Méd.Hospit. Análises e Diagnósticos</option>
                                                        <option>Siderurgia e Metalurgia</option>
                                                        <option>Tecidos. Vestuário e Calçados</option>
                                                        <option>Telecomunicações</option>
                                                        <option>Transporte</option>
                                                        <option>Viagens e Lazer</option>
                                                        <option>Shopping Centers</option>
                                                    </select>
                                                    </div>
                                                </div>
    											<div class="col-sm-6 my-1">
   												<label>Rating SeP</label>
                                                    <div class="input-group">
														<select id="SlctRatingSeP" class="form-control" style="font-size: 80%;">
                                                            <option>N/A</option>
                                                            <option>brAAA</option>
															<option>brAA+</option>
															<option>brAA</option>
															<option>brAA-</option>
															<option>brA+</option>
															<option>brA</option>
															<option>brA-</option>
															<option>brBBB+</option>
															<option>brBBB</option>
															<option>brBBB-</option>
															<option>brBB+</option>
															<option>brBB</option>
															<option>brBB-</option>
															<option>brB+</option>
															<option>brB</option>
															<option>brB-</option>
															<option>brCCC+</option>
															<option>brCCC</option>
															<option>brCCC-</option>
														</select>
                                                    </div>
                                                </div>
    											<div class="col-sm-6 my-1">
   												<label>Rating Moodys</label>
                                                    <div class="input-group">
														<select id="SlctRatingMoodys" class="form-control" style="font-size: 80%;">
                                                            <option>N/A</option>
                                                            <option>Aaa.br</option>
                                                            <option>Aa1.br</option>
                                                            <option>Aa2.br</option>
                                                            <option>Aa3.br</option>
                                                            <option>A1.br</option>
                                                            <option>A2.br</option>
                                                            <option>A3.br</option>
                                                            <option>Baa1.br</option>
                                                            <option>Baa2.br</option>
                                                            <option>Baa3.br</option>
                                                            <option>Ba1.br</option>
                                                            <option>Ba2.br</option>
                                                            <option>Ba3.br</option>
                                                            <option>B1.br</option>
                                                            <option>B2.br</option>
                                                            <option>B3.br</option>
                                                            <option>Caa1.br</option>
                                                            <option>Caa2.br</option>
                                                            <option>Caa3.br</option>
														</select>
                                                    </div>
                                                </div>
    											<div class="col-sm-6 my-1">
   												<label>Rating Fitch</label>
                                                    <div class="input-group">
														<select id="SlctRatingFitch" class="form-control" style="font-size: 80%;">
                                                                <option>N/A</option>
                                                                <option>AAA(bra)</option>
                                                                <option>AA+(bra)</option>
                                                                <option>AA(bra)</option>
                                                                <option>AA-(bra)</option>
                                                                <option>A+(bra)</option>
                                                                <option>A(bra)</option>
                                                                <option>A-(bra)</option>
                                                                <option>BBB+(bra)</option>
                                                                <option>BBB(bra)</option>
                                                                <option>BBB-(bra)</option>
                                                                <option>BB+(bra)</option>
                                                                <option>BB(bra)</option>
                                                                <option>BB-(bra)</option>
                                                                <option>B+(bra)</option>
                                                                <option>B(bra)</option>
                                                                <option>B-(bra)</option>
                                                                <option>CCC(bra)</option>
                                                                <option>CC(bra)</option>
                                                                <option>C(bra)</option>                                                            
                                                        </select>
                                                    </div>
                                                </div>

												<div class="col-sm-6 my-1">
   												<label>Categoria Listagem</label>
                                                    <div class="input-group">
														<select id="SlctCategoriaListagem" class="form-control" style="font-size: 80%;">
                                                            <option>N/A</option>
                                                            <option>Bovespa Nível 1</option>
                                                            <option>Bovespa Nível 2</option>
                                                            <option>Bovespa Novo Mercado</option>
                                                            <option>Bovespa Não Listada</option>
                                                            <option>(NM) Cia. Novo Mercado</option>
                                                            <option>(N1) Cia. Nível 1 de Governança Corporativa</option>
                                                            <option>(N2) Cia. Nível 2 de Governança Corporativa</option>
                                                            <option>(MA) Cia. Bovespa Mais</option>
                                                            <option>(M2) Cia. Bovespa Mais Nível 2</option>
                                                            <option>(MB) Cia. Balcão Org. Tradicional</option>
                                                            <option>(DR1) BDR Nível 1</option>
                                                            <option>(DR2) BDR Nível 2</option>
                                                            <option>(DR3) BDR Nível 3</option>
                                                            <option>(DRE) BDR de ETF</option>
                                                            <option>(DRN) BDR Não Patrocinado</option>
														</select>
                                                    </div>
                                                </div>

												<div class="col-sm-6 my-1">
   												<label>Tipo Cia</label>
                                                    <div class="input-group">
														<select id="SlctTipoCIA" class="form-control" style="font-size: 80%;">
                                                            <option>N/A</option>
                                                            <option>Aberta</option>
                                                            <option>Fechada</option>
                                                            <option>IF</option>
                                                            <option>PJ Direito Privado</option>
                                                        </select>
                                                    </div>
                                                </div>

												<div class="col-sm-6 my-1">
   												<label>Tipo Emissor</label>
                                                    <div class="input-group">
														<select id="SlctTipoEmissor" class="form-control" style="font-size: 80%;">
                                                            <option>N/A</option>
                                                            <option>Corporativo</option>
                                                            <option>Instituição Financeira</option>
                                                            <option>SPE</option>
                                                            <option>SPE Infraestrutura</option>
                                                            <option>Securitizadora</option>
                                                            <option>PF</option>
                                                            <option>Soberano</option>
														</select>
                                                    </div>
                                                </div>
												
											</div>

                                            <div>
                                                <a id="submit-btn-area-a" style="margin:10px 10px 0px 0px;width:150px;float:right;" onClick="Insert()" >Novo</a>                                                
                                                <a id="submit-btn-area-a" style="margin:10px 10px 0px 0px;width:150px;float:right;" onClick="Update()" >Salvar</a>
                                            </div>

                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
					
					<div class="col-lg-6 col-ml-12">
                        <div class="row">
                            <div class="col-12 mt-5">
                                <div class="card">
                                    <div class="card-body">
									
		<!-- Listbox Formulario -->							
                                                <div class="search-box pull-left" style = "margin:0px 0px 20px 0px;">
													<form action="#">
														<input type="text" id="TbSearch" name="search" placeholder="Search..." required>
														<a style="cursor:pointer;" OnClick="CarregaBusca()"><i class="ti-search"></i></a>
													</form>
												</div>

                                                <input id="hfPage" type="hidden">
                                                <input id="hfnPages" type="hidden">
                                                <div class="pull-right" style = "margin:0px 0px 50px 0px;" >									
															<nav aria-label="Page navigation example">
																<ul class="pagination justify-content-end">
                                                                     <li class="page-item">
																		<a class="page-link" OnClick="Anterior()">Anterior</a>
																	</li>
                                                                    <li class="page-item"><a id="LblDisplayPage" class="page-link" href="#">-</a></li>
																	<li class="page-item">
																		<a class="page-link" OnClick="Proximo()">Próxima</a>
																	</li>
																</ul>
															</nav>
													</div>
										
										
                                                <div class="single-table">
                                                        <div class="table-responsive">
                                                            <table class="table text-center">
                                                                <thead class="text-uppercase">
                                                                    <tr>
                                                                        <th scope="col">Nome</th>
                                                                        <th scope="col">Grupo</th>
                                                                        <th scope="col">CGC</th>
                                                                        <th scope="col"></th>
                                                                        <th scope="col"></th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody id="TblDados">
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
										
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
					
                </div>
            </div>
        </div>
        <!-- main content area end -->
        <!-- footer area start-->
        <footer>
            <div class="footer-area">
                <p>© Versão Beta</p>
            </div>
        </footer>
        <!-- footer area end-->
    </div>
    
    <script src="../static/js/modernizr-2.8.3.min.js"></script>
    <script src="../static/js/jquery-2.2.4.min.js"></script>
    <script src="../static/js/popper.min.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <script src="../static/js/owl.carousel.min.js"></script>
    <script src="../static/js/metisMenu.min.js"></script>
    <script src="../static/js/jquery.slimscroll.min.js"></script>
    <script src="../static/js/jquery.slicknav.min.js"></script>
    <script src="../static/js/plugins.js"></script>
    <script src="../static/js/scripts.js"></script>



    <script>
        var jsonData = JSON.parse('{{ jsnDt | tojson | safe}}');
        var UserName = document.getElementById('hfHeaderUserName').value;
        var picturepath = document.getElementById('hfpicture').value;
        document.getElementById('imgProfile').src = picturepath;
        document.getElementById('NameUser').innerHTML = UserName + "<i class='fa fa-angle-down'></i>";
    </script>
    
<script> 


function Update(){
var fd = new FormData();
fd.append("idUsuario", document.getElementById("hfUsuario_Id").value);
fd.append("UsuarioAuth", document.getElementById("hfUsuario_Auth").value );

fd.append("IDEmissor", document.getElementById("tbIDEmissor").value);
if( document.getElementById("tbIDEmissor").value == '') { document.getElementById("tbIDEmissor").value = -1;}
fd.append("RatingSeP", document.getElementById("SlctRatingSeP").value);
fd.append("RatingMoodys", document.getElementById("SlctRatingMoodys").value);
fd.append("RatingFitch", document.getElementById("SlctRatingFitch").value);

var RatingMinimo
var NotaRatingMinimo
var AgenciaRatingMinimo
var NotaRatingMoodys
var NotaRatingFitch
var NotaRatingSeP

NotaRatingSeP = 20
NotaRatingFitch = 20
NotaRatingMoodys = 20

if("AAA(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 19}
if("AA+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 18}
if("AA(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 17}
if("AA-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 16}
if("A+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 15}
if("A(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 14}
if("A-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 13}
if("BBB+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 12}
if("BBB(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 11}
if("BBB-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 10}
if("BB+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 9}
if("BB(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 8}
if("BB-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 7}
if("B+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 6}
if("B(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 5}
if("B-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 4}
if("CCC+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 3}
if("CCC(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 2}
if("CCC-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 1}

if("Aaa.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 19}
if("Aa1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 18}
if("Aa2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 17}
if("Aa3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 16}
if("A1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 15}
if("A2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 14}
if("A3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 13}
if("Baa1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 12}
if("Baa2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 11}
if("Baa3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 10}
if("Ba1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 9}
if("Ba2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 8}
if("Ba3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 7}
if("B1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 6}
if("B2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 5}
if("B3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 4}
if("Caa1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 3}
if("Caa2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 2}
if("Caa3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 1}

if("brAAA"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 19}
if("brAA+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 18}
if("brAA"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 17}
if("brAA-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 16}
if("brA+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 15}
if("brA"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 14}
if("brA-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 13}
if("brBBB+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 12}
if("brBBB"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 11}
if("brBBB-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 10}
if("brBB+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 9}
if("brBB"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 8}
if("brBB-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 7}
if("brB+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 6}
if("brB"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 5}
if("brB-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 4}
if("brCCC+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 3}
if("brCCC"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 2}
if("brCCC-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 1}

if(NotaRatingSeP<=NotaRatingFitch &&  NotaRatingSeP<=NotaRatingMoodys){AgenciaRatingMinimo="S&P";RatingMinimo=document.getElementById("SlctRatingSeP").value;NotaRatingMinimo=NotaRatingSeP;} 
if(NotaRatingFitch<=NotaRatingSeP &&  NotaRatingFitch<=NotaRatingMoodys){AgenciaRatingMinimo="Fitch";RatingMinimo=document.getElementById("SlctRatingFitch").value;NotaRatingMinimo=NotaRatingFitch;} 
if(NotaRatingMoodys<=NotaRatingFitch &&  NotaRatingMoodys<=NotaRatingSeP){AgenciaRatingMinimo="Moodys";RatingMinimo=document.getElementById("SlctRatingMoodys").value;NotaRatingMinimo=NotaRatingMoodys;} 

if (NotaRatingMinimo == 19){fd.append("RatingMAI", "AAA");}
else if (NotaRatingMinimo == 18){fd.append("RatingMAI", "AA");}
else if (NotaRatingMinimo == 17){fd.append("RatingMAI", "AA");}
else if (NotaRatingMinimo == 16){fd.append("RatingMAI", "AA");}
else if (NotaRatingMinimo == 15){fd.append("RatingMAI", "A");}
else if (NotaRatingMinimo == 14){fd.append("RatingMAI", "A");}
else if (NotaRatingMinimo == 13){fd.append("RatingMAI", "A");}
else if (NotaRatingMinimo == 12){fd.append("RatingMAI", "BBB");}
else if (NotaRatingMinimo == 11){fd.append("RatingMAI", "BBB");}
else if (NotaRatingMinimo == 10){fd.append("RatingMAI", "BBB");}
else if (NotaRatingMinimo == 9){fd.append("RatingMAI", "BB");}
else if (NotaRatingMinimo == 8){fd.append("RatingMAI", "BB");}
else if (NotaRatingMinimo == 7){fd.append("RatingMAI", "BB");}
else if (NotaRatingMinimo == 6){fd.append("RatingMAI", "B");}
else if (NotaRatingMinimo == 5){fd.append("RatingMAI", "B");}
else if (NotaRatingMinimo == 4){fd.append("RatingMAI", "B");}
else if (NotaRatingMinimo == 3){fd.append("RatingMAI", "CCC");}
else if (NotaRatingMinimo == 2){fd.append("RatingMAI", "CCC");}
else if (NotaRatingMinimo == 1){fd.append("RatingMAI", "CCC");}
else {fd.append("RatingMAI", document.getElementById("tbRatingMAI").value);}
fd.append("Rating", RatingMinimo);
fd.append("Agencia", AgenciaRatingMinimo);
fd.append("Categoria", document.getElementById("SlctCategoria").value);
fd.append("Grupo", document.getElementById("tbGrupo").value);
fd.append("Nome", document.getElementById("tbNome").value);
fd.append("cgc", document.getElementById("tbcgc").value);
fd.append("AliasBradesco", document.getElementById("tbAliasBradesco").value);
fd.append("AliasItau", document.getElementById("tbAliasItau").value);
fd.append("AliasMellon", document.getElementById("tbAliasMellon").value);
fd.append("TipoCIA", document.getElementById("SlctTipoCIA").value);
fd.append("CategoriaListagem", document.getElementById("SlctCategoriaListagem").value);
fd.append("Nacional", document.getElementById("cbNacional").checked);
fd.append("TipoEmissor", document.getElementById("SlctTipoEmissor").value);

var oReq = new XMLHttpRequest();
oReq.open('POST', "/Cadastro/Emissor/Update",true);
oReq.onload = function() {
            var result = JSON.parse(this.responseText);    
            if (trim(result['resposta']) == trim("Falha na Autenticação")){
                window.location.href = "/Login";
            }
            else{
                    var dvMdl = document.getElementById("tbModalMsgBox");
                    while (dvMdl.lastElementChild) {dvMdl.removeChild(dvMdl.lastElementChild);}
                    dvMdl.innerhtml = "";
                    var span = document.createElement('span');
                    span.setAttribute('style',"float:left;margin:15px 0px 0px 15px;");
                    dvMdl.appendChild(span);
                    span.innerHTML = "<p>" + trim(result['resposta']) + ".</p>";
                    $(document).ready(function(){$('#ModalMsgBox').modal('show');})
                    return;
                }
            }
            oReq.send(fd);
}

function Insert(){
var fd = new FormData();
fd.append("idUsuario", document.getElementById("hfUsuario_Id").value);
fd.append("UsuarioAuth", document.getElementById("hfUsuario_Auth").value );

fd.append("RatingSeP", document.getElementById("SlctRatingSeP").value);
fd.append("RatingMoodys", document.getElementById("SlctRatingMoodys").value);
fd.append("RatingFitch", document.getElementById("SlctRatingFitch").value);

var RatingMinimo
var NotaRatingMinimo
var AgenciaRatingMinimo
var NotaRatingMoodys
var NotaRatingFitch
var NotaRatingSeP

NotaRatingSeP = 20
NotaRatingFitch = 20
NotaRatingMoodys = 20

if("AAA(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 19}
if("AA+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 18}
if("AA(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 17}
if("AA-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 16}
if("A+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 15}
if("A(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 14}
if("A-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 13}
if("BBB+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 12}
if("BBB(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 11}
if("BBB-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 10}
if("BB+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 9}
if("BB(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 8}
if("BB-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 7}
if("B+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 6}
if("B(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 5}
if("B-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 4}
if("CCC+(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 3}
if("CCC(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 2}
if("CCC-(bra)"==document.getElementById("SlctRatingFitch").value){NotaRatingFitch = 1}

if("Aaa.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 19}
if("Aa1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 18}
if("Aa2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 17}
if("Aa3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 16}
if("A1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 15}
if("A2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 14}
if("A3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 13}
if("Baa1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 12}
if("Baa2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 11}
if("Baa3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 10}
if("Ba1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 9}
if("Ba2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 8}
if("Ba3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 7}
if("B1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 6}
if("B2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 5}
if("B3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 4}
if("Caa1.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 3}
if("Caa2.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 2}
if("Caa3.br"==document.getElementById("SlctRatingMoodys").value){NotaRatingMoodys = 1}

if("brAAA"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 19}
if("brAA+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 18}
if("brAA"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 17}
if("brAA-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 16}
if("brA+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 15}
if("brA"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 14}
if("brA-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 13}
if("brBBB+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 12}
if("brBBB"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 11}
if("brBBB-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 10}
if("brBB+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 9}
if("brBB"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 8}
if("brBB-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 7}
if("brB+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 6}
if("brB"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 5}
if("brB-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 4}
if("brCCC+"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 3}
if("brCCC"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 2}
if("brCCC-"==document.getElementById("SlctRatingSeP").value){NotaRatingSeP = 1}

if(NotaRatingSeP<=NotaRatingFitch &&  NotaRatingSeP<=NotaRatingMoodys){AgenciaRatingMinimo="S&P";RatingMinimo=document.getElementById("SlctRatingSeP").value;NotaRatingMinimo=NotaRatingSeP;} 
if(NotaRatingFitch<=NotaRatingSeP &&  NotaRatingFitch<=NotaRatingMoodys){AgenciaRatingMinimo="Fitch";RatingMinimo=document.getElementById("SlctRatingFitch").value;NotaRatingMinimo=NotaRatingFitch;} 
if(NotaRatingMoodys<=NotaRatingFitch &&  NotaRatingMoodys<=NotaRatingSeP){AgenciaRatingMinimo="Moodys";RatingMinimo=document.getElementById("SlctRatingMoodys").value;NotaRatingMinimo=NotaRatingMoodys;} 

if (NotaRatingMinimo == 19){fd.append("RatingMAI", "AAA");}
else if (NotaRatingMinimo == 18){fd.append("RatingMAI", "AA");}
else if (NotaRatingMinimo == 17){fd.append("RatingMAI", "AA");}
else if (NotaRatingMinimo == 16){fd.append("RatingMAI", "AA");}
else if (NotaRatingMinimo == 15){fd.append("RatingMAI", "A");}
else if (NotaRatingMinimo == 14){fd.append("RatingMAI", "A");}
else if (NotaRatingMinimo == 13){fd.append("RatingMAI", "A");}
else if (NotaRatingMinimo == 12){fd.append("RatingMAI", "BBB");}
else if (NotaRatingMinimo == 11){fd.append("RatingMAI", "BBB");}
else if (NotaRatingMinimo == 10){fd.append("RatingMAI", "BBB");}
else if (NotaRatingMinimo == 9){fd.append("RatingMAI", "BB");}
else if (NotaRatingMinimo == 8){fd.append("RatingMAI", "BB");}
else if (NotaRatingMinimo == 7){fd.append("RatingMAI", "BB");}
else if (NotaRatingMinimo == 6){fd.append("RatingMAI", "B");}
else if (NotaRatingMinimo == 5){fd.append("RatingMAI", "B");}
else if (NotaRatingMinimo == 4){fd.append("RatingMAI", "B");}
else if (NotaRatingMinimo == 3){fd.append("RatingMAI", "CCC");}
else if (NotaRatingMinimo == 2){fd.append("RatingMAI", "CCC");}
else if (NotaRatingMinimo == 1){fd.append("RatingMAI", "CCC");}
else {fd.append("RatingMAI", document.getElementById("tbRatingMAI").value);}
fd.append("Rating", RatingMinimo);
fd.append("Agencia", AgenciaRatingMinimo);
fd.append("Categoria", document.getElementById("SlctCategoria").value);
fd.append("Grupo", document.getElementById("tbGrupo").value);
fd.append("Nome", document.getElementById("tbNome").value);
fd.append("cgc", document.getElementById("tbcgc").value);
fd.append("AliasBradesco", document.getElementById("tbAliasBradesco").value);
fd.append("AliasItau", document.getElementById("tbAliasItau").value);
fd.append("AliasMellon", document.getElementById("tbAliasMellon").value);
fd.append("TipoCIA", document.getElementById("SlctTipoCIA").value);
fd.append("CategoriaListagem", document.getElementById("SlctCategoriaListagem").value);
fd.append("Nacional", document.getElementById("cbNacional").checked);
fd.append("TipoEmissor", document.getElementById("SlctTipoEmissor").value);


var oReq = new XMLHttpRequest();
oReq.open('POST', "/Cadastro/Emissor/Insert",true);
oReq.onload = function() {
            var result = JSON.parse(this.responseText);    
            if (trim(result['resposta']) == trim("Falha na Autenticação")){window.location.href = "/Login";}
            else{
                    var dvMdl = document.getElementById("tbModalMsgBox");
                    while (dvMdl.lastElementChild) {dvMdl.removeChild(dvMdl.lastElementChild);}
                    dvMdl.innerhtml = "";
                    var span = document.createElement('span');
                    span.setAttribute('style',"float:left;margin:15px 0px 0px 15px;");
                    dvMdl.appendChild(span);
                    span.innerHTML = "<p>" + trim(result['resposta']) + ".</p>";
                    $(document).ready(function(){$('#ModalMsgBox').modal('show');})
                    return;
                }
            }
            oReq.send(fd);
}


function CarregaBusca(){
document.getElementById("hfPage").value = 1;
var fd = new FormData();
fd.append("idUsuario", document.getElementById("hfUsuario_Id").value);
fd.append("UsuarioAuth", document.getElementById("hfUsuario_Auth").value );
fd.append("Search", document.getElementById("TbSearch").value);
fd.append("Pag", 1);
fd.append("nPerPag", 10);
var oReq = new XMLHttpRequest();
oReq.open('POST', "/Cadastro/Emissor/Search",true);
oReq.onload = function() {
                                var result = JSON.parse(this.responseText);  
                                var Tbl = document.getElementById("TblDados");
                                while (Tbl.lastElementChild) {Tbl.removeChild(Tbl.lastElementChild);}  
                                Tbl.innerhtml = "";
                                var result = JSON.parse(this.responseText);    
                                if (trim(result['resposta']) == trim("Falha na Autenticação")){window.location.href = "/Login";exit;}
                                if (trim(result['resposta']) != trim("Ok"))
                                {document.getElementById("LblDisplayPage").innerText='-';throw new Error(trim(result['resposta']));exit;}
                                else{
                                    var Dados=result['Dados'];
                                    document.getElementById("hfnPages").value = Dados["nPags"];
                                    document.getElementById("LblDisplayPage").innerText = Dados["Pag"]+" de "+Math.max(Dados["nPags"],1) ;
                                    for (k in Dados["Lista"]) {
                                                                var Header = document.createElement('tr');
                                                                Header.setAttribute('class',"heading-td")
                                                                Header.setAttribute('id',k);
                                                                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["Nome"];Header.appendChild(HeaderCol);
                                                                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["Grupo"];Header.appendChild(HeaderCol);
                                                                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["cgc"];Header.appendChild(HeaderCol);
                                                                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = '<a id="DeleteObj#'+k+'" onClick="Delete(this.id)"><i class="ti-trash"></i></a>';Header.appendChild(HeaderCol);
                                                                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = '<a id="DisplayObj#'+k+'" onClick="Display(this.id)"><i class="ti-eye"></i></a>';Header.appendChild(HeaderCol);
                                                                Tbl.appendChild(Header);
                                                                }
                                }
                            }
oReq.send(fd);
}


function Display(s){
var idLista = document.getElementById(s).id;
var fd = new FormData();
fd.append("IDEmissor", trim(Right(idLista,idLista.length-idLista.search("#")-1)));
fd.append("idUsuario", document.getElementById("hfUsuario_Id").value);
fd.append("UsuarioAuth", document.getElementById("hfUsuario_Auth").value );
var oReq = new XMLHttpRequest();
oReq.open('POST', "/Cadastro/Emissor/Load",true);
oReq.onload = function() {
                            var result = JSON.parse(this.responseText); 
                            if (trim(result['resposta']) == trim("Falha na Autenticação")){window.location.href = "/Login";exit;}
                            if (trim(result['resposta']) != trim("Ok")){throw new Error(trim(result['resposta']));exit;}
                            else{
                                var Dados=result['Dados'];
                                document.getElementById("tbIDEmissor").value = Dados["IDEmissor"];
                                document.getElementById("tbRating").value = Dados["Rating"];
                                document.getElementById("tbAgencia").value = Dados["Agencia"];
                                document.getElementById("tbRatingMAI").value = Dados["RatingMAI"];
                                document.getElementById("SlctCategoria").value = Dados["Categoria"];
                                document.getElementById("tbGrupo").value = Dados["Grupo"];
                                document.getElementById("tbNome").value = Dados["Nome"];
                                document.getElementById("tbcgc").value = Dados["cgc"];
                                document.getElementById("tbAliasBradesco").value = Dados["AliasBradesco"];
                                document.getElementById("tbAliasItau").value = Dados["AliasItau"];
                                document.getElementById("tbAliasMellon").value = Dados["AliasMellon"];
                                document.getElementById("SlctTipoCIA").value = Dados["TipoCIA"];
                                document.getElementById("SlctCategoriaListagem").value = Dados["CategoriaListagem"];
                                document.getElementById("cbNacional").checked = Dados["Nacional"];
                                document.getElementById("SlctTipoEmissor").value = Dados["TipoEmissor"];
                                document.getElementById("SlctRatingSeP").value = Dados["RatingSeP"];
                                document.getElementById("SlctRatingMoodys").value = Dados["RatingMoodys"];
                                document.getElementById("SlctRatingFitch").value = Dados["RatingFitch"];
                            }
                          }
oReq.send(fd);
}

function Delete(s){
var idLista = document.getElementById(s).id;
var fd = new FormData();
fd.append("IDEmissor", trim(Right(idLista,idLista.length-idLista.search("#")-1)));
fd.append("idUsuario", document.getElementById("hfUsuario_Id").value);
fd.append("UsuarioAuth", document.getElementById("hfUsuario_Auth").value );
var oReq = new XMLHttpRequest();
        oReq.open('POST', "/Cadastro/Emissor/Delete",true);
        oReq.onload = function() {
                                        var result = JSON.parse(this.responseText); 
                                        if (trim(result['resposta']) == trim("Falha na Autenticação")){window.location.href = "/Login";exit;}
                                        else{



                                            var Tbl = document.getElementById("TblDados");
                                                var vv = false;
                                                for (var i = 0, row; row = Tbl.rows[i]; i++) {
                                                    if (row.getAttribute('id') == trim(Right(idLista, idLista.length - idLista.search("#") - 1))) {
                                                        Tbl.deleteRow(i);
                                                    }
                                                }   


                                                var dvMdl = document.getElementById("tbModalMsgBox");
                                                while (dvMdl.lastElementChild) {dvMdl.removeChild(dvMdl.lastElementChild);}
                                                dvMdl.innerhtml = "";
                                                var span = document.createElement('span');
                                                span.setAttribute('style',"float:left;margin:15px 0px 0px 15px;");
                                                dvMdl.appendChild(span);
                                                span.innerHTML = "<p>" + trim(result['resposta']) + ".</p>";
                                                $(document).ready(function(){$('#ModalMsgBox').modal('show');})
                                                return;
                                            }
                                   }
        oReq.send(fd);
}

function Proximo(){

if(parseFloat(document.getElementById("hfnPages").value) >= parseFloat(document.getElementById("hfPage").value)+1)
{document.getElementById("hfPage").value=parseFloat(document.getElementById("hfPage").value)+1;}

var fd = new FormData();
fd.append("idUsuario", document.getElementById("hfUsuario_Id").value);
fd.append("UsuarioAuth", document.getElementById("hfUsuario_Auth").value );
fd.append("Search", document.getElementById("TbSearch").value);
fd.append("Pag", document.getElementById("hfPage").value);
fd.append("nPerPag", 10);

var oReq = new XMLHttpRequest();
oReq.open('POST', "/Cadastro/Emissor/Search",true);
oReq.onload = function() {
        var result = JSON.parse(this.responseText);  
        var Tbl = document.getElementById("TblDados"); 
        var result = JSON.parse(this.responseText);    
        if (trim(result['resposta']) == trim("Falha na Autenticação")){window.location.href = "/Login";exit;}
        if (trim(result['resposta']) != trim("Ok"))
        {document.getElementById("LblDisplayPage").innerText='-';throw new Error(trim(result['resposta']));exit;}
        else{
            while (Tbl.lastElementChild) {Tbl.removeChild(Tbl.lastElementChild);}  
            Tbl.innerhtml = "";
            var Dados=result['Dados'];
            document.getElementById("hfnPages").value = Dados["nPags"];
            document.getElementById("LblDisplayPage").innerText = Dados["Pag"]+" de "+Math.max(Dados["nPags"],1) ;
            for (k in Dados["Lista"]) {
                var Header = document.createElement('tr');
                Header.setAttribute('class',"heading-td")
                Header.setAttribute('id',k);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["Nome"];Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["Grupo"];Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["cgc"];Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = '<a id="DeleteObj#'+k+'" onClick="Delete(this.id)"><i class="ti-trash"></i></a>';Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = '<a id="DisplayObj#'+k+'" onClick="Display(this.id)"><i class="ti-eye"></i></a>';Header.appendChild(HeaderCol);
                Tbl.appendChild(Header);
                }
        }
    }
oReq.send(fd);
}

function Anterior(){

if(1 <= parseFloat(document.getElementById("hfPage").value)-1)
{document.getElementById("hfPage").value=parseFloat(document.getElementById("hfPage").value)-1;}
else{throw new Error("Não tem pagina menor que 1!");}

var fd = new FormData();
fd.append("idUsuario", document.getElementById("hfUsuario_Id").value);
fd.append("UsuarioAuth", document.getElementById("hfUsuario_Auth").value );
fd.append("Search", document.getElementById("TbSearch").value);
fd.append("Pag", document.getElementById("hfPage").value);
fd.append("nPerPag", 10);
var oReq = new XMLHttpRequest();
oReq.open('POST', "/Cadastro/Emissor/Search",true);
oReq.onload = function() {
        var result = JSON.parse(this.responseText);  
        var Tbl = document.getElementById("TblDados"); 
        var result = JSON.parse(this.responseText);    
        if (trim(result['resposta']) == trim("Falha na Autenticação")){window.location.href = "/Login";exit;}
        if (trim(result['resposta']) != trim("Ok"))
        {document.getElementById("LblDisplayPage").innerText='-';throw new Error(trim(result['resposta']));exit;}
        else{
            while (Tbl.lastElementChild) {Tbl.removeChild(Tbl.lastElementChild);}  
            Tbl.innerhtml = "";
            var Dados=result['Dados'];
            document.getElementById("hfnPages").value = Dados["nPags"];
            document.getElementById("LblDisplayPage").innerText = Dados["Pag"]+" de "+Math.max(Dados["nPags"],1) ;
            for (k in Dados["Lista"]) {
                var Header = document.createElement('tr');
                Header.setAttribute('class',"heading-td")
                Header.setAttribute('id',k);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["Nome"];Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["Grupo"];Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = Dados["Lista"][k]["cgc"];Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = '<a id="DeleteObj#'+k+'" onClick="Delete(this.id)"><i class="ti-trash"></i></a>';Header.appendChild(HeaderCol);
                var HeaderCol = document.createElement('td');HeaderCol.innerHTML = '<a id="DisplayObj#'+k+'" onClick="Display(this.id)"><i class="ti-eye"></i></a>';Header.appendChild(HeaderCol);
                Tbl.appendChild(Header);
                }
        }
    }
oReq.send(fd);
}


</script>



</body>

</html>
